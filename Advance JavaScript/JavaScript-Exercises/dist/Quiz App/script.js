const quizQuestions = [
    {
        question: "What is entrepreneurship?",
        options: [
            "The process of buying and selling products",
            "The process of designing, launching, and running a new business",
            "The process of managing a large corporation",
            "The process of marketing existing products"
        ],
        correctAnswer: 1
    },
    {
        question: "Which of the following is NOT a factor contributing to the growth of entrepreneurship?",
        options: [
            "Economic development",
            "Government policies",
            "Inheritance of wealth",
            "Technological advancement"
        ],
        correctAnswer: 2
    },
    {
        question: "Who is known as an entrepreneur?",
        options: [
            "A person who starts a new business",
            "A person who works for a corporation",
            "A person who buys a franchise",
            "A person who invests in stocks"
        ],
        correctAnswer: 0
    },
    {
        question: "Which of the following best describes an intrapreneur?",
        options: [
            "An employee who acts like an entrepreneur within a company",
            "A manager who oversees the entire business",
            "A person who owns a small business",
            "A person who invests in multiple businesses"
        ],
        correctAnswer: 0
    },
    {
        question: "What is the primary difference between an entrepreneur and a manager?",
        options: [
            "Entrepreneurs take risks, managers do not",
            "Entrepreneurs manage employees, managers do not",
            "Entrepreneurs work for others, managers do not",
            "There is no difference between them"
        ],
        correctAnswer: 0
    },
    {
        question: "Which type of entrepreneur is known for introducing new products and ideas?",
        options: [
            "Imitative entrepreneur",
            "Innovative entrepreneur",
            "Fabian entrepreneur",
            "Drone entrepreneur"
        ],
        correctAnswer: 1
    },
    {
        question: "What motivates a social entrepreneur?",
        options: [
            "Maximizing profits",
            "Achieving social change",
            "Gaining market share",
            "Becoming a market leader"
        ],
        correctAnswer: 1
    },
    {
        question: "Which of the following is NOT a characteristic of entrepreneurship?",
        options: [
            "Innovation",
            "Risk-taking",
            "Routine management",
            "Opportunity recognition"
        ],
        correctAnswer: 2
    },
    {
        question: "Which type of entrepreneur prefers to follow others rather than innovate?",
        options: [
            "Fabian entrepreneur",
            "Innovative entrepreneur",
            "Imitative entrepreneur",
            "Drone entrepreneur"
        ],
        correctAnswer: 2
    },
    {
        question: "What is the key difference between an entrepreneur and an intrapreneur?",
        options: [
            "An entrepreneur owns the business, an intrapreneur works within a business",
            "An entrepreneur works within a business, an intrapreneur owns the business",
            "There is no difference between them",
            "An entrepreneur is always more successful than an intrapreneur"
        ],
        correctAnswer: 0
    },
    {
        question: "Entrepreneurs who resist change and avoid innovation are known as:",
        options: [
            "Fabian entrepreneurs",
            "Drone entrepreneurs",
            "Imitative entrepreneurs",
            "Innovative entrepreneurs"
        ],
        correctAnswer: 1
    },
    {
        question: "What is one of the most significant risks faced by entrepreneurs?",
        options: [
            "Job security",
            "Market uncertainty",
            "Guaranteed profit",
            "High salaries"
        ],
        correctAnswer: 1
    },
    {
        question: "Which of the following statements is true about entrepreneurship?",
        options: [
            "It requires no planning",
            "It involves significant risk and uncertainty",
            "It is only for large corporations",
            "It guarantees success and profit"
        ],
        correctAnswer: 1
    },
    {
        question: "What is a key role of an entrepreneur in the economy?",
        options: [
            "To stabilize the economy",
            "To drive innovation and economic growth",
            "To regulate market activities",
            "To avoid competition"
        ],
        correctAnswer: 1
    },
    {
        question: "Which of the following is an example of a social entrepreneur?",
        options: [
            "Someone who starts a business to maximize profits",
            "Someone who starts a business to address social issues",
            "Someone who invests in multiple businesses",
            "Someone who buys a franchise"
        ],
        correctAnswer: 1
    },
    {
        question: "Which entrepreneur is more likely to bring radical changes to the market?",
        options: [
            "Fabian entrepreneur",
            "Innovative entrepreneur",
            "Imitative entrepreneur",
            "Drone entrepreneur"
        ],
        correctAnswer: 1
    },
    {
        question: "What distinguishes a Fabian entrepreneur from a drone entrepreneur?",
        options: [
            "Fabian entrepreneurs are aggressive risk-takers",
            "Fabian entrepreneurs are cautious but eventually adapt, while drone entrepreneurs resist change entirely",
            "Fabian entrepreneurs are highly innovative",
            "There is no difference between them"
        ],
        correctAnswer: 1
    },
    {
        question: "Which type of entrepreneur operates in niche markets with unique products or services?",
        options: [
            "Market saturators",
            "Market segmenters",
            "Risk averters",
            "Market expanders"
        ],
        correctAnswer: 1
    },
    {
        question: "What is the primary motivation for most entrepreneurs?",
        options: [
            "High salaries",
            "Job security",
            "The desire to create and innovate",
            "Avoidance of responsibility"
        ],
        correctAnswer: 2
    },
    {
        question: "Which of the following is a common challenge faced by entrepreneurs?",
        options: [
            "Access to unlimited capital",
            "Guaranteed market success",
            "High risk of failure",
            "Government-provided customers"
        ],
        correctAnswer: 2
    },
    {
        question: "Entrepreneurs who create and run multiple businesses simultaneously or sequentially are known as:",
        options: [
            "Serial entrepreneurs",
            "Social entrepreneurs",
            "Corporate entrepreneurs",
            "Intrapreneurs"
        ],
        correctAnswer: 0
    },
    {
        question: "Which of the following best describes a drone entrepreneur?",
        options: [
            "Innovative and risk-taking",
            "Avoids competition and resists changes",
            "Follows others and imitates products",
            "Focuses on social change"
        ],
        correctAnswer: 1
    },
    {
        question: "What is the ability to turn an idea into a profitable business known as?",
        options: [
            "Risk-taking",
            "Innovation",
            "Venture creation",
            "Market analysis"
        ],
        correctAnswer: 2
    },
    {
        question: "What type of entrepreneur is motivated by the desire to achieve social goals rather than profit?",
        options: [
            "Commercial entrepreneur",
            "Social entrepreneur",
            "Intrapreneur",
            "Drone entrepreneur"
        ],
        correctAnswer: 1
    },
    {
        question: "Which of the following is an example of intrapreneurship?",
        options: [
            "Starting a new business outside a corporation",
            "Developing a new product within an existing company",
            "Buying a franchise",
            "Imitating a competitor's business model"
        ],
        correctAnswer: 1
    },
    {
        question: "Entrepreneurs who inherit a family business but do not innovate are known as:",
        options: [
            "Innovative entrepreneurs",
            "Imitative entrepreneurs",
            "Fabian entrepreneurs",
            "Drone entrepreneurs"
        ],
        correctAnswer: 3
    },
    {
        question: "What is the term used to describe the process of starting a new business venture?",
        options: [
            "Entrepreneurship",
            "Management",
            "Administration",
            "Marketing"
        ],
        correctAnswer: 0
    },
    {
        question: "Which of the following is NOT a characteristic of a successful entrepreneur?",
        options: [
            "Innovation",
            "Risk-taking",
            "Averseness to change",
            "Opportunity recognition"
        ],
        correctAnswer: 2
    },
    {
        question: "What is a key factor that distinguishes entrepreneurs from non-entrepreneurs?",
        options: [
            "Wealth",
            "Risk tolerance",
            "Job security",
            "Education level"
        ],
        correctAnswer: 1
    },
    {
        question: "Which of the following statements is true about drone entrepreneurs?",
        options: [
            "They are highly innovative",
            "They resist change and avoid competition",
            "They focus on social entrepreneurship",
            "They operate in niche markets"
        ],
        correctAnswer: 1
    },
    {
        question: "Entrepreneurs who focus on improving existing products or services are known as:",
        options: [
            "Innovative entrepreneurs",
            "Imitative entrepreneurs",
            "Fabian entrepreneurs",
            "Drone entrepreneurs"
        ],
        correctAnswer: 1
    },
    {
        question: "Which of the following is a trait of a successful entrepreneur?",
        options: [
            "Aversion to risk",
            "Fear of failure",
            "Perseverance",
            "Avoidance of responsibility"
        ],
        correctAnswer: 2
    },
    {
        question: "Entrepreneurs who are motivated by the desire to create something new and unique are known as:",
        options: [
            "Fabian entrepreneurs",
            "Imitative entrepreneurs",
            "Drone entrepreneurs",
            "Innovative entrepreneurs"
        ],
        correctAnswer: 3
    },
    {
        question: "Which type of entrepreneur typically operates in a stable market with little competition?",
        options: [
            "Innovative entrepreneur",
            "Fabian entrepreneur",
            "Imitative entrepreneur",
            "Drone entrepreneur"
        ],
        correctAnswer: 3
    },
    {
        question: "Entrepreneurs who adapt and eventually adopt new technologies or innovations are known as:",
        options: [
            "Fabian entrepreneurs",
            "Innovative entrepreneurs",
            "Imitative entrepreneurs",
            "Drone entrepreneurs"
        ],
        correctAnswer: 0
    },
    {
        question: "Which of the following best describes the role of an entrepreneur in the economy?",
        options: [
            "To avoid risks and maintain the status quo",
            "To innovate and create new opportunities",
            "To manage existing businesses",
            "To follow the lead of others"
        ],
        correctAnswer: 1
    },
    {
        question: "Which type of entrepreneur focuses on bringing social change rather than profit?",
        options: [
            "Commercial entrepreneur",
            "Social entrepreneur",
            "Intrapreneur",
            "Fabian entrepreneur"
        ],
        correctAnswer: 1
    },
    {
        question: "Which of the following is NOT an example of entrepreneurship?",
        options: [
            "Starting a new business",
            "Developing a new product",
            "Managing an existing team",
            "Launching a new service"
        ],
        correctAnswer: 2
    },
    {
        question: "Entrepreneurs who strictly follow traditional practices and resist innovation are known as:",
        options: [
            "Fabian entrepreneurs",
            "Drone entrepreneurs",
            "Imitative entrepreneurs",
            "Innovative entrepreneurs"
        ],
        correctAnswer: 1
    },
    {
        question: "What is a significant characteristic of entrepreneurship?",
        options: [
            "Avoiding risks",
            "High tolerance for ambiguity",
            "Lack of ambition",
            "Focusing on short-term goals"
        ],
        correctAnswer: 1
    },
    {
        question: "Which of the following is a common goal for social entrepreneurs?",
        options: [
            "Maximizing personal wealth",
            "Driving social change",
            "Achieving market dominance",
            "Avoiding competition"
        ],
        correctAnswer: 1
    },
    {
        question: "Which of the following statements about innovative entrepreneurs is true?",
        options: [
            "They avoid taking risks",
            "They bring new ideas and products to the market",
            "They imitate others' ideas",
            "They resist change"
        ],
        correctAnswer: 1
    },
    {
        question: "Entrepreneurs who introduce a new product to the market are known as:",
        options: [
            "Imitative entrepreneurs",
            "Drone entrepreneurs",
            "Fabian entrepreneurs",
            "Innovative entrepreneurs"
        ],
        correctAnswer: 3
    },
    {
        question: "Which of the following is NOT a characteristic of an entrepreneur?",
        options: [
            "Creativity",
            "Risk aversion",
            "Leadership",
            "Innovation"
        ],
        correctAnswer: 1
    },
    {
        question: "Which of the following best describes an imitative entrepreneur?",
        options: [
            "Creates entirely new products or services",
            "Adapts existing products or services",
            "Resists all forms of change",
            "Focuses solely on profit"
        ],
        correctAnswer: 1
    }
];

// Shuffle questions when the page loads
quizQuestions.sort(() => Math.random() - 0.5);

let currentQuestionIndex = 0;
let score = 0;
let userName = '';
let userClass = '';
let quizDate = '';
let timer; // Timer variable
let timeLeft = 60; // Time left for each question (60 seconds)
let isTabActive = true; // Flag to check if the tab is active

const introContainer = document.getElementById('intro');
const quizContainer = document.getElementById('quiz');
const resultContainer = document.getElementById('result');
const questionElement = document.getElementById('question');
const optionsContainer = document.getElementById('options');
const scoreElement = document.getElementById('score');
const resultTextElement = document.getElementById('resultText');
const studentNameElement = document.getElementById('studentName');
const studentClassElement = document.getElementById('studentClass');
const quizDateElement = document.getElementById('quizDate');
const nextBtn = document.getElementById('nextBtn');
const prevBtn = document.getElementById('prevBtn');
const startBtn = document.getElementById('startBtn');
const timerElement = document.createElement('div'); // Timer display element

startBtn.addEventListener('click', startQuiz);
nextBtn.addEventListener('click', goToNextQuestion);
prevBtn.addEventListener('click', goToPreviousQuestion);

window.addEventListener('beforeunload', (event) => {
    if (quizContainer.classList.contains('d-none')) {
        return;
    }
    event.preventDefault();
    autoSubmitQuiz();
    event.returnValue = ''; // This triggers the dialog for leaving the page
});

document.addEventListener('visibilitychange', () => {
    if (document.visibilityState === 'hidden') {
        isTabActive = false;
        autoSubmitCurrentQuestion();
    } else {
        isTabActive = true;
    }
});

function startQuiz() {
    userName = document.getElementById('name').value.trim();
    userClass = document.getElementById('class').value;
    quizDate = new Date().toLocaleString();
    if (userName === '') {
        alert('Please enter your name.');
        return;
    }
    introContainer.classList.add('d-none');
    quizContainer.classList.remove('d-none');
    displayQuestion(currentQuestionIndex);
}

function displayQuestion(index) {
    const currentQuestion = quizQuestions[index];
    questionElement.textContent = currentQuestion.question;
    optionsContainer.innerHTML = '';

    // Display timer for the question
    timeLeft = 60;
    timerElement.textContent = `Time left: ${timeLeft}s`;
    timerElement.className = 'mt-3';
    quizContainer.insertBefore(timerElement, optionsContainer);

    currentQuestion.options.forEach((option, i) => {
        const optionButton = document.createElement('button');
        optionButton.classList.add('list-group-item', 'list-group-item-action');
        optionButton.textContent = option;
        optionButton.onclick = () => handleAnswer(i, optionButton);
        optionsContainer.appendChild(optionButton);
    });

    prevBtn.classList.toggle('d-none', index === 0);
    nextBtn.classList.add('d-none');

    // Start countdown timer
    startTimer();
}

function startTimer() {
    clearInterval(timer); // Clear any existing timer
    timer = setInterval(() => {
        timeLeft--;
        if (!isTabActive) {
            clearInterval(timer);
            return;
        }
        timerElement.textContent = `Time left: ${timeLeft}s`;

        if (timeLeft <= 0) {
            clearInterval(timer);
            autoSubmitCurrentQuestion();
        }
    }, 1000);
}

function handleAnswer(selectedOption, optionButton) {
    const currentQuestion = quizQuestions[currentQuestionIndex];
    if (selectedOption === currentQuestion.correctAnswer) {
        score++;
    }
    // Change the selected option's color to green
    optionButton.style.backgroundColor = '#28a745';
    optionButton.style.color = '#fff';

    // Disable all options after selection
    Array.from(optionsContainer.children).forEach(button => {
        button.disabled = true;
    });

    nextBtn.classList.remove('d-none');
    clearInterval(timer); // Stop the timer after the user selects an answer
}

function goToNextQuestion() {
    currentQuestionIndex++;
    if (currentQuestionIndex < quizQuestions.length) {
        displayQuestion(currentQuestionIndex);
    } else {
        displayResult();
    }
}

function goToPreviousQuestion() {
    currentQuestionIndex--;
    if (currentQuestionIndex >= 0) {
        displayQuestion(currentQuestionIndex);
    }
}

function displayResult() {
    quizContainer.classList.add('d-none');
    resultContainer.classList.remove('d-none');
    scoreElement.textContent = score;
    studentNameElement.textContent = userName;
    studentClassElement.textContent = userClass;
    quizDateElement.textContent = quizDate;

    let resultText;

    if (score >= 45) {
        resultText = 'Excellent!';
    } else if (score >= 30) {
        resultText = 'Good Job!';
    } else if (score >= 20) {
        resultText = 'Fair';
    } else {
        resultText = 'Better Luck Next Time!';
    }

    resultTextElement.textContent = resultText;
}

function autoSubmitCurrentQuestion() {
    // Auto-submit the current question if time runs out or tab is switched
    Array.from(optionsContainer.children).forEach(button => {
        button.disabled = true;
    });
    goToNextQuestion();
}

function autoSubmitQuiz() {
    if (quizContainer.classList.contains('d-none')) {
        return;
    }
    displayResult();
}